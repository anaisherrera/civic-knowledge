---
title: "conocimiento_civico"
author: "Anais Herrera Leighton"
date: "11-12-2020"
output: html_document
---


```{r}
pacman::p_load(ggplot2,
               hrbrthemes,
               sjPlot,
               extrafont,
               haven,
               dplyr)
load(file= "../input/data/proc/data.Rdata")
load(file= "../input/data/proc/data1.Rdata")
iccs_simce <- read_dta("../input/data/original/iccs_simce.dta")
```

```{r}
set_theme(base = theme_classic(),
          theme.font = "Calibri", 
          axis.textsize.x = 1.2,
          axis.textsize.y = 1.2, 
          geom.label.size = 4, 
          legend.just = 0.35, 
          legend.size = 1.2,
          legend.backgroundcol = "white")

old <- theme_set(theme_classic())
theme_update(plot.caption = element_text(size = 12),
             text=element_text(size=12,  family="Calibri"))
```

#1a.	Sentido de autoeficacia política 
```{r}
p1a <- ggplot(data, aes(x=PV1CIV, y=S_CITEFF)) +
  geom_point(color="#535151") +
  geom_smooth(method=lm, color="#000000", fill="#D1CACA", se=TRUE, na.rm=TRUE) + xlab("Conocimiento cívico") + ylab("Autoeficacia ciudadana")
p1a
ggsave(p1a, file = "../output/graphs/1a_autoeficacia.png",device = "png",width = 20,height = 13,dpi = "retina",units = "cm")
```

#1b. Discusión política 
```{r}
p1b <- ggplot(data, aes(x=PV1CIV, y=S_POLDISC)) +
  geom_point(color="#535151") +
  geom_smooth(method=lm, color="#000000", fill="#D1CACA", se=TRUE) + xlab("Conocimiento cívico") + ylab("Discusión política")
p1b
ggsave(p1b, file = "../output/graphs/1b_discusion.png",device = "png",width = 20,height = 13,dpi = "retina",units = "cm")
```

#1c. Uso del internet con fines políticos 
```{r}
iccs_simce <- iccs_simce %>%
group_by(idschool) %>%
mutate(m_S_SOCMED = mean(S_SOCMED))

p1c <- ggplot(data, aes(x=PV1CIV, y=S_SOCMED)) +
  geom_point(color="#535151") +
  geom_smooth(method=lm, color="#000000", fill="#D1CACA", se=TRUE) + xlab("Conocimiento cívico") + ylab("Uso de internet para política")
p1c
ggsave(p1c, file = "../output/graphs/1c_internet.png",device = "png",width = 20,height = 13,dpi = "retina",units = "cm")

p1c2 <- ggplot(iccs_simce, aes(x=PV1CIV, y=m_S_SOCMED)) +
  geom_point(color="#535151") +
  geom_smooth(method=lm, color="#000000", fill="#D1CACA", se=TRUE) + xlab("Conocimiento cívico") + ylab("Uso de RRSS para temas políticos")
p1c2
ggsave(p1c2, file = "../output/graphs/1c_internet_centrado.png",device = "png",width = 20,height = 13,dpi = "retina",units = "cm")
```

#2a. Creencias autoritarias
```{r}
p2a <- ggplot(data, aes(x=PV1CIV, y=L_AUTGOV)) +
  geom_point(color="#535151") +
  geom_smooth(method=lm, color="#000000", fill="#D1CACA", se=TRUE) + xlab("Conocimiento cívico") + ylab("Creencias autoritarias")
p2a
ggsave(p2a, file = "../output/graphs/2a_autoritarias.png",device = "png",width = 20,height = 13,dpi = "retina",units = "cm")
```
#2b. Confianza en instituciones
```{r}
p2b <- ggplot(data, aes(x=PV1CIV, y=S_INTRUST)) +
  geom_point(color="#535151") +
  geom_smooth(method=lm, color="#000000", fill="#D1CACA", se=TRUE) + xlab("Conocimiento cívico") + ylab("Confianza en instituciones")
p2b
ggsave(p2b, file = "../output/graphs/2b_confianza.png",device = "png",width = 20,height = 13,dpi = "retina",units = "cm")
```

#2c. Actitudes hacia la desobediencia de la ley
```{r}
p2c <- ggplot(data, aes(x=PV1CIV, y=L_DISLAW)) +
  geom_point(color="#535151") + #787878
  geom_smooth(method=lm, color="#000000", fill="#D1CACA", se=TRUE) + xlab("Conocimiento cívico") + ylab("Desobediencia a la ley")#69b3a2 - DEDEDE -B8B4B4
p2c
ggsave(p2c, file = "../output/graphs/2c_desobediencia.png",device = "png",width = 20,height = 13,dpi = "retina",units = "cm")
```

#3a. Actitudes hacia la igualdad de género
```{r}
p3a <- ggplot(data, aes(x=PV1CIV, y=S_GENEQL)) +
  geom_point(color="#535151") + 
  geom_smooth(method=lm, color="#000000", fill="#D1CACA", se=TRUE) + xlab("Conocimiento cívico") + ylab("Igualdad de género")
p3a
ggsave(p3a, file = "../output/graphs/3a_genero.png",device = "png",width = 20,height = 13,dpi = "retina",units = "cm")
```

#3b. Actitudes hacia la igualdad con grupos étnicos
```{r}
p3b <- ggplot(data, aes(x=PV1CIV, y=S_ETHRGHT)) +
  geom_point(color="#535151") + 
  geom_smooth(method=lm, color="#000000", fill="#D1CACA", se=TRUE) + xlab("Conocimiento cívico") + ylab("Igualdad para grupos étnicos")
p3b
ggsave(p3b, file = "../output/graphs/3b_etnicos.png",device = "png",width = 20,height = 13,dpi = "retina",units = "cm")
```

#3c. Tolerancia a la diversidad en el vecindario
```{r}
p3c <- ggplot(data, aes(x=PV1CIV, y=L_ATTDIV)) +
  geom_point(color="#535151") + 
  geom_smooth(method=lm, color="#000000", fill="#D1CACA", se=TRUE) + xlab("Conocimiento cívico") + ylab("Aceptación de la diversidad")
p3c
ggsave(p3c, file = "../output/graphs/3c_diversidad.png",device = "png",width = 20,height = 13,dpi = "retina",units = "cm")
```

#4a. Disposición a la participación electoral
```{r}
p4a <- ggplot(data, aes(x=PV1CIV, y=S_ELECPART)) +
  geom_point(color="#535151") + 
  geom_smooth(method=lm, color="#000000", fill="#D1CACA", se=TRUE) + xlab("Conocimiento cívico") + ylab("Participación en elecciones")
p4a
ggsave(p4a, file = "../output/graphs/4a_partelectoral.png",device = "png",width = 20,height = 13,dpi = "retina",units = "cm")
```

#4b. Disposición a la participación en actividades legales
```{r}
p4b <- ggplot(data, aes(x=PV1CIV, y=S_LEGACT)) +
  geom_point(color="#535151") + 
  geom_smooth(method=lm, color="#000000", fill="#D1CACA", se=TRUE) + xlab("Conocimiento cívico") + ylab("Participación en actividades legales")
p4b
ggsave(p4b, file = "../output/graphs/4b_partactlegal.png",device = "png",width = 20,height = 13,dpi = "retina",units = "cm")
```
#4c. Disposición a la participación en actividades ilegales
```{r}
p4c <- ggplot(data, aes(x=PV1CIV, y=S_ILLACT)) +
  geom_point(color="#535151") + 
  geom_smooth(method=lm, color="#000000", fill="#D1CACA", se=TRUE) + xlab("Conocimiento cívico") + ylab("Participación en actividades ilegales")
p4c
ggsave(p4c, file = "../output/graphs/4c_partactilegal.png",device = "png",width = 20,height = 13,dpi = "retina",units = "cm")
```
# Gráfico común
```{r}
general <- cowplot::plot_grid(p1a,p1b,p1c,p2a,p2b,p2c,p3a,p3b,p3c,p4a,p4b,p4c, ncol=3)
#ggsave(general, file = "../output/graphs/general.png",device = "png",width = 30,height = 30,dpi = "retina",units = "cm") #tamaño de letra 14
```

```{r}
ggsave(plot = plot_grid(list(p1a,p1b,p1c,p2a,p2b,p2c,p3a,p3b,p3c,p4a,p4b,p4c),
                        margin = c(0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4), 
                        tags = c(" ", " ", " ", " ", " ", " "," ", " ", " ", " ", " ", " ")),
       filename = "../output/graphs/general2.png", width = 11, height = 10, dpi= "retina")

ggsave(plot = plot_grid(list(p1a,p1b,p1c,p2a,p2b,p2c,p3a,p3b,p3c,p4a,p4b,p4c),
                        margin = c(0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6), 
                        tags = c(" ", " ", " ", " ", " ", " "," ", " ", " ", " ", " ", " ")),
       filename = "../output/graphs/general2.png", width = 11, height = 10, dpi= "retina")
```

#Nivel educativo
```{r message=FALSE, warning=FALSE}
mean_cc <- mean(data1$PV1CIV)

plotdata <- data1 %>%
  group_by(S_HISCED) %>%
  summarize(n = n(),
         mean = mean(PV1CIV),
         sd = sd(PV1CIV),
         se = sd / sqrt(n),
         ci = qt(0.99, df = n - 1) * sd / sqrt(n))

#font_import()
#loadfonts(device="win")       #Register fonts for Windows bitmap output
#fonts()                       #vector of font family names

plotdata$S_HISCED <- factor(plotdata$S_HISCED, levels = c(0,1,2,3,4), labels = c("Menor a 6° básico","Entre 6° y menor a 8°", "Ed. media completa","Ed. Superior no universitaria", "Ed. Universitaria y más"))
plotdata<-na.omit(plotdata)

plot_ed <- ggplot(plotdata, 
       aes(x = S_HISCED, 
           y = mean, 
           group = 1)) +
  geom_errorbar(aes(ymin = mean - se, 
                    ymax = mean + se), 
                width = .05, colour="grey50") +
  geom_point(shape = 21, colour = "#5A5858", fill = "white", size = 1.8) +
  geom_hline(yintercept = mean_cc,
             color = "grey50",
             linetype = "solid") + 
  xlab("Niveles de educación familiar CINE") + ylab("Conocimiento cívico")  + ggtitle("CONOCIMIENTO CÍVICO, SEGÚN NIVEL EDUCACIONAL") + theme_classic() +
    theme(axis.title.x = element_text(hjust = 0.48),
          axis.text.x = element_text(colour = "black", size = 10, angle = 45, hjust = 1),
          plot.title = element_text(family="Times New Roman",hjust=0.5)) + ylim(400,550)

ggsave(plot_ed, file = "../output/graphs/nivel_educacional.png",device = "png",width = 20,height = 13,dpi = "retina",units = "cm")
```
# Estatus ocupacional
```{r}
plot_est <- ggplot(data1, aes(x=S_HISEI, y=PV1CIV)) +
  geom_point(color="#535151") + 
  geom_smooth(method=lm, color="#000000", fill="#D1CACA", se=TRUE) + xlab("Estatus ocupacional Padre/Madre") + ylab("Conocimiento cívico") + ggtitle("CONOCIMIENTO CÍVICO, SEGÚN ESTATUS OCUPACIONAL DE LOS PADRES") + theme_classic() +
    theme(plot.title = element_text(family="Times New Roman",hjust=0.5)) + xlim(20,100)

plot_est
ggsave(plot_est, file = "../output/graphs/estatus.png",device = "png",width = 20,height = 13,dpi = "retina",units = "cm")
```

#Libros en el hogar
```{r}
mean_cc <- mean(data1$PV1CIV)

plotdata <- data1 %>%
  group_by(S_HOMLIT) %>%
  summarize(n = n(),
         mean = mean(PV1CIV),
         sd = sd(PV1CIV),
         se = sd / sqrt(n),
         ci = qt(0.99, df = n - 1) * sd / sqrt(n))

plotdata$S_HOMLIT <- factor(plotdata$S_HOMLIT, levels = c(0,1,2,3,4), labels = c("0-10 libros","11-25 libros", "26-100 libros","101-200 libros", "Más de 200 libros"))
plotdata<-na.omit(plotdata)

plot_lib <- ggplot(plotdata, 
       aes(x = S_HOMLIT, 
           y = mean, 
           group = 1)) +
  geom_errorbar(aes(ymin = mean - se, 
                    ymax = mean + se), 
                width = .05, colour="grey50") +
  geom_point(shape = 21, colour = "#5A5858", fill = "white", size = 1.8) +
  geom_hline(yintercept = mean_cc,
             color = "grey50",
             linetype = "solid") + 
  xlab("Número de libros en el hogar") + ylab("Conocimiento cívico")  + ggtitle("CONOCIMIENTO CÍVICO, SEGÚN LIBROS EN EL HOGAR") + theme_classic() +
    theme(axis.title.x = element_text(hjust = 0.48),
          axis.text.x = element_text(colour = "black", size = 10, angle = 45, hjust = 1),
          plot.title = element_text(family="Times New Roman",hjust=0.5)) + ylim(400,550)

ggsave(plot_lib, file = "../output/graphs/libros.png",device = "png",width = 20,height = 13,dpi = "retina",units = "cm")
```

#Interés político
```{r}
mean_cc <- mean(data1$PV1CIV)

plotdata <- data1 %>%
  group_by(S_HINT) %>%
  summarize(n = n(),
         mean = mean(PV1CIV),
         sd = sd(PV1CIV),
         se = sd / sqrt(n),
         ci = qt(0.99, df = n - 1) * sd / sqrt(n))

plotdata$S_HINT <- factor(plotdata$S_HINT, levels = c(0,1,2,3), labels = c("Nada interesado","No muy interesado", "Bastante interesado", "Muy interesado"))
plotdata<-na.omit(plotdata)

plot_intpol <- ggplot(plotdata, 
       aes(x = S_HINT, 
           y = mean, 
           group = 1)) +
  geom_errorbar(aes(ymin = mean - se, 
                    ymax = mean + se), 
                width = .05, colour="grey50") +
  geom_point(shape = 21, colour = "#5A5858", fill = "white", size = 1.8) +
  geom_hline(yintercept = mean_cc,
             color = "grey50",
             linetype = "solid") + 
  xlab("Interés político familiar") + ylab("Conocimiento cívico")  + ggtitle("CONOCIMIENTO CÍVICO, SEGÚN INTERÉS POLÍTICO DE LOS PADRES") + theme_classic() +
    theme(axis.title.x = element_text(hjust = 0.48),
          axis.text.x = element_text(colour = "black", size = 10, angle = 45, hjust = 1),
          plot.title = element_text(family="Times New Roman",hjust=0.5)) + ylim(400,550)

ggsave(plot_intpol, file = "../output/graphs/intpol.png",device = "png",width = 20,height = 13,dpi = "retina",units = "cm")
```